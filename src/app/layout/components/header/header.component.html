<mat-toolbar class="header-toolbar">

  <!-- Mobile Menu Button -->
  <button 
    mat-icon-button 
    class="menu-button"
    *ngIf="isHandset"
    (click)="onMenuToggle()"
    aria-label="Toggle navigation">
    <mat-icon>menu</mat-icon>
  </button>

  <!-- Logo/Brand -->
  <div class="brand" [class.mobile]="isHandset">
    <div class="logo">
      <mat-icon class="logo-icon">business</mat-icon>
      <span class="brand-text" [class.hidden]="isHandset">HRMS</span>
    </div>
  </div>

  <!-- Spacer -->
  <span class="spacer"></span>

  <!-- Header Actions -->
  <div class="header-actions">

<!-- Toolbar search icon -->
<button 
  mat-icon-button 
  class="action-button"
  *ngIf="!isHandset && !isSearchOpen"
  matTooltip="Search"
  aria-label="Search"
  (click)="toggleSearch()">
  <mat-icon>search</mat-icon>
</button>

<!-- Search input -->
<div class="header-search" *ngIf="isSearchOpen">
  <input
    #searchInput
    type="text"
    placeholder="Search dashboard..."
    [(ngModel)]="searchQuery"
    (ngModelChange)="onSearchChange($event)"
    (keydown.enter)="onSearch()"
  />
  <button mat-icon-button (click)="onSearch()">
    <mat-icon>search</mat-icon>
  </button>

  <!-- Dropdown suggestions -->
  <ul class="search-suggestions" *ngIf="filteredItems.length > 0">
    <li *ngFor="let item of filteredItems" (click)="goToSection(item.id)">
      {{ item.name }}
    </li>
  </ul>
</div>


    <!-- Theme Toggle -->
    <button 
      mat-icon-button 
      class="action-button"
      (click)="onThemeToggle()"
      [matTooltip]="isDarkMode ? 'Switch to Light Mode' : 'Switch to Dark Mode'"
      aria-label="Toggle theme">
      <mat-icon>{{ isDarkMode ? 'light_mode' : 'dark_mode' }}</mat-icon>
    </button>

    <!-- Notifications -->
    <div class="notification-container">
      <button 
        mat-icon-button 
        class="action-button"
        (click)="onNotificationsClick()"
        matTooltip="Notifications"
        aria-label="Notifications">
        <mat-icon 
          [matBadge]="notificationCount" 
          [matBadgeHidden]="notificationCount === 0"
          matBadgeColor="warn" 
          matBadgeSize="small">
          notifications
        </mat-icon>
      </button>

      <!-- Dropdown -->
      <div class="notification-panel" *ngIf="isNotificationOpen">
        <app-notification-dialogue 
          [isOpen]="isNotificationOpen"
          (unreadCountChange)="notificationCount = $event">
        </app-notification-dialogue>
      </div>
    </div>

    <!-- User Menu -->
    <button mat-icon-button class="user-menu-button-pic" [matMenuTriggerFor]="userMenu" aria-label="User menu">
      <div class="user-avatar-pic">
        <p-avatar
          *ngIf="profilePreviewUrl; else initials"
          [image]="profilePreviewUrl"
          shape="circle"
          styleClass="user-avatar-large-content">
        </p-avatar>

        <ng-template #initials>
          <p-avatar
            [label]="getUserInitials()"
            shape="circle"
            styleClass="user-avatar-large-content">
          </p-avatar>
        </ng-template>
      </div>
    </button>

  </div>

  <!-- User Menu -->
  <mat-menu #userMenu="matMenu" class="user-menu">
    <div class="user-menu-header">
      <div class="user-info">
        <div class="user-avatar-large">
          <p-avatar 
            *ngIf="profilePreviewUrl; else initialsLarge"
            [image]="profilePreviewUrl"
            size="large"
            shape="circle"
            styleClass="user-avatar-large-content">
          </p-avatar>

          <ng-template #initialsLarge>
            <p-avatar 
              [label]="getUserInitials()"
              size="large"
              shape="circle"
              styleClass="user-avatar-large-content">
            </p-avatar>
          </ng-template>
        </div>
        <div class="user-details">
          <div class="user-name">{{ getUserDisplayName() }}</div>
          <div class="user-email">{{ currentUser?.email }}</div>
          <div class="user-role">{{ currentUser?.roleName }}</div>
        </div>
      </div>
    </div>

    <mat-divider></mat-divider>

    <button mat-menu-item (click)="onProfileClick()">
      <mat-icon>person</mat-icon>
      <span>My Profile</span>
    </button>

    <button mat-menu-item (click)="onSettingsClick()">
      <mat-icon>settings</mat-icon>
      <span>Settings</span>
    </button>

    <mat-divider></mat-divider>

    <button mat-menu-item class="logout-item" (click)="onLogout()">
      <mat-icon>logout</mat-icon>
      <span>Logout</span>
    </button>
  </mat-menu>

</mat-toolbar>
