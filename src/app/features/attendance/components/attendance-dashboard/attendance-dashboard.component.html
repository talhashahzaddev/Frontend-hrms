
<!-- My Attendance Container -->
<div class="attendance-dashboard-container">
  
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        <mat-icon>access_time</mat-icon>
        My Attendance
      </h1>
      <p class="page-subtitle">Track and view your attendance history</p>
    </div>
    
    <div class="current-time">
      <div class="time-display">{{ currentTime | date:'HH:mm:ss' }}</div>
      <div class="date-display">{{ currentTime | date:'dd-MM-yyyy' }}</div>
    </div>
  </div>

  <!-- Main Content Tabs -->
  <mat-card class="main-content-card">
    <mat-tab-group>
      
      <!-- Calendar View Tab -->
      <mat-tab label="Calendar View">
        <div class="tab-content">  
         <app-attendance-calendar></app-attendance-calendar>


     
        </div>
      </mat-tab>
<mat-tab label="List View">
  <div class="tab-content">

    <!-- Date Range Filter -->
    <div class="list-filters">
      <mat-form-field appearance="outline" class="date-field">
        <mat-label>Start Date</mat-label>
        <mat-icon matPrefix>event</mat-icon>
        <input matInput 
               [matDatepicker]="listStartPicker" 
               [formControl]="listStartDateControl"
               placeholder="Select start date">
        <mat-datepicker-toggle matIconSuffix [for]="listStartPicker"></mat-datepicker-toggle>
        <mat-datepicker #listStartPicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="outline" class="date-field">
        <mat-label>End Date</mat-label>
        <mat-icon matPrefix>event</mat-icon>
        <input matInput 
               [matDatepicker]="listEndPicker" 
               [formControl]="listEndDateControl"
               placeholder="Select end date">
        <mat-datepicker-toggle matIconSuffix [for]="listEndPicker"></mat-datepicker-toggle>
        <mat-datepicker #listEndPicker></mat-datepicker>
      </mat-form-field>

      <button mat-flat-button (click)="loadEmployeeAttendance()" class="load-button">
        <mat-icon>refresh</mat-icon>
        <span>Load Data</span>
      </button>
    </div>

    <!-- Loading Indicator -->
    <div *ngIf="isLoadingList" class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading attendance records...</p>
    </div>


   <div class="attendance-container">

  <div class="table-card">

    <div class="table-container">

      <!-- Attendance Table -->
      <table mat-table [dataSource]="dataSource" class="employee-table">

        <!-- Employee Name Column -->
        <ng-container matColumnDef="employeeName">
          <th mat-header-cell *matHeaderCellDef>Employee</th>
          <td mat-cell *matCellDef="let session">
            <div class="employee-info">

              <!-- Avatar -->
              <div class="employee-avatar">
                <mat-icon>person</mat-icon>
              </div>

              <div class="employee-details">
                <div class="employee-name">{{ session.employeeName }}</div>
              </div>

            </div>
          </td>
        </ng-container>

        <!-- Work Date Column -->
        <ng-container matColumnDef="workDate">
          <th mat-header-cell *matHeaderCellDef>Work Date</th>
          <td mat-cell *matCellDef="let session">
            <mat-icon>calendar_today</mat-icon>
            {{ session.workDate | date:'dd-MM-yyyy' }}
          </td>
        </ng-container>

        <!-- Check In Column -->
        <ng-container matColumnDef="checkInTime">
          <th mat-header-cell *matHeaderCellDef>Check In</th>
          <td mat-cell *matCellDef="let session">
            <mat-icon>login</mat-icon>
            {{ session.checkInTime ? (session.checkInTime | date:'HH:mm') : '--:--' }}
          </td>
        </ng-container>

        <!-- Check Out Column -->
        <ng-container matColumnDef="checkOutTime">
          <th mat-header-cell *matHeaderCellDef>Check Out</th>
          <td mat-cell *matCellDef="let session">
            <mat-icon>logout</mat-icon>
            {{ session.checkOutTime ? (session.checkOutTime | date:'HH:mm') : '--:--' }}
          </td>
        </ng-container>

        <!-- Location Column -->
        <ng-container matColumnDef="location">
          <th mat-header-cell *matHeaderCellDef>Location</th>
          <td mat-cell *matCellDef="let session">
            <ng-container *ngIf="session.location; else noLocation">
              <mat-icon>location_on</mat-icon> {{ session.location }}
            </ng-container>
            <ng-template #noLocation>--</ng-template>
          </td>
        </ng-container>

        <!-- Header & Rows -->
        <tr mat-header-row *matHeaderRowDef="['employeeName','workDate','checkInTime','checkOutTime','location']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['employeeName','workDate','checkInTime','checkOutTime','location'];">
        </tr>

      </table>

      <!-- Empty State -->
      <div *ngIf="dataSource.data.length === 0" class="empty-state">
        <mat-icon>event_busy</mat-icon>
        <h3>No Attendance Records</h3>
        <p>No attendance records found for the selected date range.</p>
      </div>

    </div>

  </div>

</div>

<!-- Pagination -->
<mat-paginator
  *ngIf="!isLoadingList && dataSource.data.length > 0"
  [length]="totalCount"
  [pageSize]="pageSize"
  [pageSizeOptions]="[5, 10, 20, 50]"
  [pageIndex]="currentPage - 1"
  (page)="loadEmployeeAttendance($event.pageIndex + 1, $event.pageSize)"
  showFirstLastButtons>
</mat-paginator>






  </div>
</mat-tab>


      
      <!-- Summary Tab -->
      <mat-tab label="Summary">
        <div class="tab-content">
          <div class="summary-content" *ngIf="attendanceSummary">
            <div class="summary-stats">
              <div class="summary-stat">
                <div class="stat-icon success">
                  <mat-icon>check_circle</mat-icon>
                </div>
                <div class="stat-info">
                  <div class="stat-number">{{ attendanceSummary.presentDays || 0 }}</div>
                  <div class="stat-label">Present Days</div>
                </div>
              </div>
              
              <div class="summary-stat">
                <div class="stat-icon danger">
                  <mat-icon>cancel</mat-icon>
                </div>
                <div class="stat-info">
                  <div class="stat-number">{{ attendanceSummary.absentDays || 0 }}</div>
                  <div class="stat-label">Absent Days</div>
                </div>
              </div>
              
              <div class="summary-stat">
                <div class="stat-icon warning">
                  <mat-icon>schedule</mat-icon>
                </div>
                <div class="stat-info">
                  <div class="stat-number">{{ attendanceSummary.lateDays || 0 }}</div>
                  <div class="stat-label">Late Days</div>
                </div>
              </div>
              
              <div class="summary-stat">
                <div class="stat-icon primary">
                  <mat-icon>access_time</mat-icon>
                </div>
                <div class="stat-info">
                  <div class="stat-number">{{ formatHours(attendanceSummary.totalHours || 0) }}</div>
                  <div class="stat-label">Total Hours</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="no-summary" *ngIf="!attendanceSummary">
            <mat-icon>analytics</mat-icon>
            <p>Generate a report to view summary statistics</p>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </mat-card>
</div>
